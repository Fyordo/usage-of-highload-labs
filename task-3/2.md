# Задание 2: Наблюдение за VFS

### Трассировка команды `cat /etc/os-release > /dev/null`

```
vboxuser@Ubuntu:~/Desktop$ strace -e trace=openat,read,write,close cat /etc/os-release > /dev/null
openat(AT_FDCWD, "/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
close(3)                                = 0
openat(AT_FDCWD, "/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\220\243\2\0\0\0\0\0"..., 832) = 832
close(3)                                = 0
openat(AT_FDCWD, "/usr/lib/locale/locale-archive", O_RDONLY|O_CLOEXEC) = 3
close(3)                                = 0
openat(AT_FDCWD, "/etc/os-release", O_RDONLY) = 3
read(3, "PRETTY_NAME=\"Ubuntu 24.04.3 LTS\""..., 131072) = 400
write(1, "PRETTY_NAME=\"Ubuntu 24.04.3 LTS\""..., 400) = 400
read(3, "", 131072)                     = 0
close(3)                                = 0
close(1)                                = 0
close(2)                                = 0
+++ exited with 0 +++
```

## Описание открываемого и читаемого файла

Основной файл, который открывается и читается в контексте команды `cat /etc/os-release`, это:

- **`/etc/os-release`**: Это файл, который содержит информацию об операционной системе, такую как имя, версия, и т.д.
  - **Открытие**: Системный вызов `openat(AT_FDCWD, "/etc/os-release", O_RDONLY) = 3` открывает этот файл **только для чтения** (`O_RDONLY`). Ему присваивается файловый дескриптор `3`.
  - **Чтение**: Вызов `read(3, "PRETTY_NAME=\"Ubuntu 24.04.3 LTS\""..., 131072) = 400` считывает содержимое файла (400 байт), начиная с "PRETTY_NAME="Ubuntu 24.04.3 LTS"...".
  - **Повторное чтение**: Вызов `read(3, "", 131072) = 0` показывает, что достигнут конец файла, так как было прочитано 0 байт.
  - **Закрытие**: Вызов `close(3) = 0` закрывает файл.

### Другие открываемые файлы

- **`/etc/ld.so.cache`**: Кэш динамического компоновщика.
- **`/lib/x86_64-linux-gnu/libc.so.6`**: Динамически загружаемая стандартная библиотека языка C (glibc).
- **`/usr/lib/locale/locale-archive`**: Файл, содержащий данные о языке.

---

## Объяснение отсутствия записывающих вызовов

В выводе `strace` _присутствуют_ записывающие вызовы, но они **не производят записи в `/dev/null`**.

1.  **Записывающий вызов**:

    ```
    write(1, "PRETTY_NAME=\"Ubuntu 24.04.3 LTS\""..., 400) = 400
    ```

    Этот вызов `write` пытается записать 400 байт прочитанных данных в **файловый дескриптор 1**, который по умолчанию соответствует **stdout**.

2.  **Перенаправление в `/dev/null`**:

    - Открывается файл `/dev/null` для записи.
    - Она связывает **stdout** программы `cat` с этим открытым файлом `/dev/null`.

3.  **Результат**:
    Когда программа `cat` выполняет системный вызов `write(1, ...)`, **ядро операционной системы** направляет эти данные в файл, связанный с дескриптором 1, то есть в **`/dev/null`**.

**Отсутствие `openat` для `/dev/null` и `write` в файл:**
`strace` показывает только те системные вызовы, которые выполняет сама программа **`cat`**.

- Команда `cat` не выполняет `openat` для `/dev/null` или любого другого файла, потому что перенаправление (связывание дескриптора 1 с `/dev/null`) было выполнено shell до запуска `cat`.
- Команда `cat` выполняет `write` в дескриптор `1`, который уже перенаправлен.

Таким образом, записывающий вызов **есть** (`write(1, ...)`), но он направляет данные в **`/dev/null`** из-за перенаправления, выполненного оболочкой, а не в результате прямого вызова `openat` и `write` в `/dev/null` внутри самой программы `cat`.
